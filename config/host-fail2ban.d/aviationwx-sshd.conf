# Host-level Fail2ban Configuration for AviationWX Server
# Strict protection for SSH access on port 22 (host management)
# 
# This file should be deployed to: /etc/fail2ban/jail.d/aviationwx-sshd.conf
#
# IMPORTANT: This is for HOST-level SSH (port 22), not container services!
# Container services (FTP/SFTP on 2121/2122/2222) use separate, more forgiving rules.

[DEFAULT]
# Strict ban policy for host SSH access: 5 failures = 7 day ban
bantime = 604800
findtime = 600
maxretry = 5
backend = systemd
destemail = root@localhost
sendername = Fail2Ban-Host
action = %(action_)s

# sshd jail - Strict protection for host SSH on port 22
[sshd]
enabled = true
port = 22
filter = sshd
logpath = /var/log/auth.log
maxretry = 5
findtime = 600
bantime = 604800
action = iptables-multiport[name=SSHD, port="22", protocol=tcp]
