# Fail2ban Jail Configuration for AviationWX Push Webcams
# Monitors FTP/FTPS and SFTP services running in container

[DEFAULT]
# Ban policy for camera uploads: Forgiving to allow configuration mistakes
# 10 failures in 1 hour = 1 hour ban (quick recovery for legitimate cameras)
bantime = 3600
findtime = 3600
maxretry = 10
backend = auto
destemail = root@localhost
sendername = Fail2Ban
action = %(action_)s

# vsftpd jail (FTP/FTPS on ports 2121, 2122)
# Forgiving for camera misconfigurations while still preventing brute force
[vsftpd]
enabled = true
port = 2121,2122
filter = vsftpd
logpath = /var/log/vsftpd.log
maxretry = 10
findtime = 3600
bantime = 3600
action = iptables-multiport[name=VSFTPD, port="2121,2122", protocol=tcp]

# sshd-sftp jail (SFTP on port 2222)
# Forgiving for camera misconfigurations while still preventing brute force
[sshd-sftp]
enabled = true
port = 2222
filter = sshd-sftp
logpath = /var/log/auth.log
maxretry = 10
findtime = 3600
bantime = 3600
action = iptables-multiport[name=SSHD-SFTP, port="2222", protocol=tcp]

