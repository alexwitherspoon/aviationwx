# Fail2ban Jail Configuration for AviationWX Push Webcams
# Monitors FTP/FTPS and SFTP services running in container

[DEFAULT]
# Ban policy: 3 failures in 10 minutes = 30 day ban (permanent for repeat offenders)
bantime = 2592000
findtime = 600
maxretry = 3
backend = auto
destemail = root@localhost
sendername = Fail2Ban
action = %(action_)s

# vsftpd jail (FTP/FTPS on ports 2121, 2122)
[vsftpd]
enabled = true
port = 2121,2122
filter = vsftpd
logpath = /var/log/vsftpd.log
maxretry = 3
findtime = 600
bantime = 2592000
action = iptables-multiport[name=VSFTPD, port="2121,2122", protocol=tcp]

# sshd-sftp jail (SFTP on port 2222)
[sshd-sftp]
enabled = true
port = 2222
filter = sshd-sftp
logpath = /var/log/auth.log
maxretry = 3
findtime = 600
bantime = 2592000
action = iptables-multiport[name=SSHD-SFTP, port="2222", protocol=tcp]

